<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lark Driveå‹•ç”»åŸ‹ã‚è¾¼ã¿ãƒ†ã‚¹ãƒˆ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 50px auto;
      padding: 20px;
    }
    .test-section {
      margin-bottom: 40px;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    h2 {
      color: #333;
      border-bottom: 2px solid #4CAF50;
      padding-bottom: 10px;
    }
    .status {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
    }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    .info { background: #d1ecf1; color: #0c5460; }
    video {
      width: 100%;
      max-width: 800px;
      border-radius: 8px;
    }
    iframe {
      width: 100%;
      height: 500px;
      border: none;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>ğŸ§ª Lark Driveå‹•ç”»åŸ‹ã‚è¾¼ã¿ãƒ†ã‚¹ãƒˆ</h1>

  <!-- ãƒ†ã‚¹ãƒˆ1: iframeåŸ‹ã‚è¾¼ã¿ -->
  <div class="test-section">
    <h2>ãƒ†ã‚¹ãƒˆ1: iframeåŸ‹ã‚è¾¼ã¿</h2>
    <div class="status info">
      <strong>æ‰‹é †:</strong>
      <ol>
        <li>Lark Driveã§å‹•ç”»ã®å…±æœ‰ãƒªãƒ³ã‚¯ã‚’å–å¾—</li>
        <li>ä¸‹è¨˜ã® [LARK_SHARE_LINK] ã‚’å®Ÿéš›ã®URLã«ç½®ãæ›ãˆ</li>
        <li>ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ç¢ºèª</li>
      </ol>
    </div>

    <!-- ã“ã“ã«å®Ÿéš›ã®Larkå…±æœ‰ãƒªãƒ³ã‚¯ã‚’å…¥ã‚Œã‚‹ -->
    <iframe
      src="[LARK_SHARE_LINK]"
      allow="autoplay; fullscreen"
      allowfullscreen
    ></iframe>

    <div id="iframe-result" class="status">çµæœ: å¾…æ©Ÿä¸­...</div>
  </div>

  <!-- ãƒ†ã‚¹ãƒˆ2: ç›´æ¥ãƒªãƒ³ã‚¯ï¼ˆvideoè¦ç´ ï¼‰ -->
  <div class="test-section">
    <h2>ãƒ†ã‚¹ãƒˆ2: ç›´æ¥å‹•ç”»ãƒªãƒ³ã‚¯ï¼ˆvideoè¦ç´ ï¼‰</h2>
    <div class="status info">
      <strong>æ³¨æ„:</strong> Larkã®ç›´æ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URLãŒå¿…è¦ã§ã™ï¼ˆAPIçµŒç”±ã§å–å¾—ï¼‰
    </div>

    <video id="test-video" controls>
      <source src="[LARK_DIRECT_URL]" type="video/mp4">
      ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å‹•ç”»ã‚¿ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚
    </video>

    <div id="video-result" class="status">çµæœ: å¾…æ©Ÿä¸­...</div>
  </div>

  <!-- ãƒ†ã‚¹ãƒˆ3: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š -->
  <div class="test-section">
    <h2>ãƒ†ã‚¹ãƒˆ3: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š</h2>
    <div id="performance-result" class="status info">
      <strong>æ¸¬å®šé …ç›®:</strong>
      <ul id="metrics">
        <li>å†ç”Ÿé–‹å§‹æ™‚é–“: <span id="load-time">-</span></li>
        <li>ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°å›æ•°: <span id="buffer-count">0</span></li>
        <li>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯å¦: <span id="download-check">ç¢ºèªä¸­...</span></li>
      </ul>
    </div>
  </div>

  <!-- ãƒ†ã‚¹ãƒˆ4: ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ -->
  <div class="test-section">
    <h2>ãƒ†ã‚¹ãƒˆ4: ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</h2>
    <div class="status info">
      <strong>ç¢ºèªé …ç›®:</strong>
      <ul>
        <li>âœ“ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã‹</li>
        <li>âœ“ ä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã‹</li>
        <li>âœ“ ã‚¹ãƒãƒ›ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã‹</li>
        <li>âœ“ å³ã‚¯ãƒªãƒƒã‚¯â†’ã€Œåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½ã‹</li>
      </ul>
    </div>
    <div id="access-result" class="status">çµæœ: æ‰‹å‹•ã§ç¢ºèªã—ã¦ãã ã•ã„</div>
  </div>

  <script>
    // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š
    const video = document.getElementById('test-video');
    let bufferCount = 0;
    const startTime = performance.now();

    if (video) {
      // å†ç”Ÿé–‹å§‹æ™‚é–“ã‚’æ¸¬å®š
      video.addEventListener('loadeddata', () => {
        const loadTime = performance.now() - startTime;
        document.getElementById('load-time').textContent =
          `${(loadTime / 1000).toFixed(2)}ç§’`;

        const result = document.getElementById('video-result');
        if (loadTime < 3000) {
          result.className = 'status success';
          result.textContent = 'âœ… æˆåŠŸ: 3ç§’ä»¥å†…ã«å†ç”Ÿé–‹å§‹';
        } else {
          result.className = 'status error';
          result.textContent = 'âš ï¸ è­¦å‘Š: å†ç”Ÿé–‹å§‹ã«3ç§’ä»¥ä¸Šã‹ã‹ã£ã¦ã„ã¾ã™';
        }
      });

      // ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°æ¤œå‡º
      video.addEventListener('waiting', () => {
        bufferCount++;
        document.getElementById('buffer-count').textContent = bufferCount;
      });

      // ã‚¨ãƒ©ãƒ¼æ¤œå‡º
      video.addEventListener('error', (e) => {
        const result = document.getElementById('video-result');
        result.className = 'status error';
        result.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: å‹•ç”»ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ - ' +
          (video.error ? video.error.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼');
      });

      // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯å¦ãƒã‚§ãƒƒã‚¯
      video.addEventListener('loadedmetadata', () => {
        const src = video.querySelector('source').src;
        if (src && src !== '[LARK_DIRECT_URL]') {
          // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯å¦ã‚’åˆ¤å®š
          const downloadable = !video.hasAttribute('controlslist') ||
                             !video.getAttribute('controlslist').includes('nodownload');
          document.getElementById('download-check').textContent =
            downloadable ? 'âš ï¸ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½' : 'âœ… ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é˜²æ­¢æ¸ˆã¿';
        }
      });
    }

    // iframeèª­ã¿è¾¼ã¿ç¢ºèª
    const iframe = document.querySelector('iframe');
    if (iframe && iframe.src !== '[LARK_SHARE_LINK]') {
      iframe.addEventListener('load', () => {
        const result = document.getElementById('iframe-result');
        result.className = 'status success';
        result.textContent = 'âœ… æˆåŠŸ: iframeãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ';
      });

      iframe.addEventListener('error', () => {
        const result = document.getElementById('iframe-result');
        result.className = 'status error';
        result.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: iframeã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ï¼ˆCORSåˆ¶é™ã®å¯èƒ½æ€§ï¼‰';
      });
    }
  </script>
</body>
</html>
